<script>
var gasClientUtils = (function(my) {

    // calling GAS server function with promise
    my.promiseRun = function(func) {

      // convert the arguments array into an array, and drop the first one
      const runArgs = Array.prototype.slice.call(arguments).slice(1);

      return new Promise(function(resolve, reject) {
          google.script.run
             .withSuccessHandler(function(result) {
                 resolve(result);
              })
             .withFailureHandler(function(error) {
                 showError(error);
                 reject(error);
             })
            [func].apply(this, runArgs);
      });
    }


    /**
     * Logs an error message and shows an alert to the user.
     */
    function showError(error) {
        console.log(error);
        alert('Error: ' + error);
    }

    return my;
} (gasClientUtils || {}));
</script>